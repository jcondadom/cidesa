<?php
// auto-generated by PropelCidesa
// date: 2017/05/21 06:09:50
?>
<?php

/**
 *
 * @package    Roraima
 * @subpackage vistas
 
 * @author     $Author: lhernandez $ <desarrollo@cidesa.com.ve>
 * @version    SVN: $Id: _edit_form.php 32815 2009-09-08 16:52:04Z lhernandez $
 * @copyright  Copyright 2007, Cide S.A.
 *
 */
 ?>
<script type="text/javascript">
function abrir(pos)
{
var w=window.open('../../../../herramientas.php/generales/catalogo/clase/caregart/frame/sf_admin_edit_form/metodo/Caregart_FapedidoNew/obj1/ax_'+pos+'_3/campo1/Codart/obj2/ax_'+pos+'_3/campo2/codart/obj3/ax_'+pos+'_4/campo3/desart/param1/14/param2/'+jq('fafactur_codalmcaj').value+'/0/val2','true','menubar=no,toolbar=no,scrollbars=yes,width=490,height=490,resizable=yes,left=500,top=80');w.focus();return false;
}
function fun_borrar(pos)
{
 if (confirm("¿Esta seguro de eliminar el artículo?"))
 {
 	document.getElementById("table_articulos").deleteRow(pos);
 }
 else
 {
	return false;
 }
}
</script>
<?php 
//verificar el editar
if ($radarventas->getId()!="")
{
?>
	<?php
	$connection = Propel::getConnection();
	$query = "select c.codart as codigo,c.desart as descripcion,d.cantot as cantidad,c.unimed as unidad 
	from detradarventas d
	inner join caregart c on c.codart=d.codart
	where radarventas_id=".$radarventas->getId();	
	$statement = $connection->prepareStatement($query);
	$resultset = $statement->executeQuery();
	$i=1;
        foreach($resultset as $value): 
	?>	
	<script type="text/javascript">
		
		var jq = jQuery.noConflict();
		jq(document).ready(function() {
		jq("#fila0").hide();
		var cant = parseInt(<?php echo $i?>) + 1;	
		var cod = '<?php echo $value['codigo']?>';
		var des = '<?php echo $value['descripcion']?>';	
		var cantot = '<?php echo $value['cantidad']?>';	
		var uni = '<?php echo $value['unidad']?>';	
	    var markup = "<tr class='af af"+cant+" id='fila"+cant+"'  height='15'><td class='grid_fila' height='15' align='center'><img src='/images/delete.png' id='"+cant+"' class='borrar' onclick='fun_borrar("+cant+")'></td><td class='grid_fila g_a_k ac"+cant+" height='15' align='center'><input id='ax_"+cant+"_1' class='grid_txtcenter afil"+cant+" acol1' name='grida["+cant+"][0]' value='1' style='border:none' tabindex='' onchange=' onclick='marcardesc(this.id)' type='checkbox'><input id='ax_"+cant+"_2' class='a_ids ac1' name='grida["+cant+"][1]' value='' type='hidden'></td><td class='grid_fila g_a_t ac2' height='15' align='left'><input id='ax_"+cant+"_3' class='grid_txtleft afil0 acol3' name='grida["+cant+"][2]' value='"+cod+"' style='border:none' tabindex='' onchange='' onblur='javascript:event.keyCode=13; ajaxarticulosfactura(event,this.id);' size='25' maxlength='14' onkeydown='javascript:return dFilter (event.keyCode, this,'###-##-##-####')' onkeypress='javascript:cadena=rayaenter2(event,this.value);if (event.keyCode==13 || event.keyCode==9){document.getElementById(this.id).value=cadena;} perderfocus(event,this.id,21);' type='text'><input id='popup_a_"+cant+"_3' class='imagencatgrid ' value='...' onclick='abrir("+cant+");' type='button'></td><td class='grid_fila g_a_t ac3' height='15' align='left'><textarea id='ax_"+cant+"_4' class='afil0 acol4' name='grida["+cant+"][3]' style='border:none' tabindex='' onchange='' onblur='' rows='1' cols='30'>"+des+"</textarea></td><td class='grid_fila g_a_t ac4' height='15' align='left'>"+uni+"<input id='ax_"+cant+"_5' class='grid_txtleft afil0 acol5' name='grida["+cant+"][4]' value='' style='border:none' tabindex='' onchange='' onblur='' size='15' readonly='readonly' type='text'><input id='ax_"+cant+"_6' class='a_ids ac5' name='grida["+cant+"][5]' value='' type='hidden'></td><td class='grid_fila g_a_m ac6' height='25' align='right'><input id='ax_"+cant+"_7' class='grid_txtright afil0 acol7' name='grida["+cant+"][6]' value='"+cantot+"' style='border:none' tabindex='' onchange='' onblur='javascript: obj=this; ValidarMontoGridv2(obj,2);' size='10' onkeypress='cansol(event,this.id);' type='text'></td></tr>";

		    jq("#table_articulos tbody").append(markup);
		    jq("#cantidad").val(cant);

	});
	</script>	    
	<?php
	$i++;

	endforeach;?>
<script type="text/javascript">		
var jq = jQuery.noConflict();
jq(document).ready(function() {
	jq('#radarventas_ruta_id').val(jq('#radarventas_ruta_id').val()).change();
});
</script>
<?php 
}?>


<?php echo form_tag('radarventas/save', array(
  'id'        => 'sf_admin_edit_form',
  'name'      => 'sf_admin_edit_form',
  'multipart' => true,
  'onsubmit'  => 'return false;',
)) ?>

<?php echo object_input_hidden_tag($radarventas, 'getId') ?>

<?php
  $fields = RadarventasPeer::getFieldNames();

  if(array_search('Codalmusu', $fields))
  {  ?>
  <h2 class="h2" onclick="javascript: return $('divusualms').toggle();"><?php echo __('Almacenes') ?></h2>
  <fieldset id="sf_fieldset_usualms" class="">
  <div class="form-row" id="divusualms">
    <?php echo label_for('radarventas[codalmusu]', __('Almacenes Por Usuario: '), 'class="required" Style="text-align:left; width:150px"') ?>
    <div class="content">
    <?php
      $almacenes = $sf_user->getAttribute('usualms',array());
      if(count($almacenes)>0){
        $keys = array_keys($almacenes);
        $codalm = $keys[0];
      }else $codalm = '';
      if($codalm == '') echo label_for('radarventas[codalmusu]', __('Usuario sin Almacen Asociado'), 'class="required" Style="text-align:left; width:150px"').'<br><br><br>';
      else echo select_tag('radarventas[codalmusu]',options_for_select($almacenes,$radarventas->getCodalmusu()!='' ? $radarventas->getCodalmusu() : $codalm), ( ($radarventas->getId()) ? 'disabled=true' : '').' style=width:500px');
    ?>
    </div>
  </div>
  </fieldset>
<?php } ?>



<fieldset id="sf_fieldset_none" class="">

<div class="form-row" id="divNONE">
<div id="divruta_id">
  <?php if($labels['radarventas{ruta_id}']!='.:') { ?>
  <?php echo label_for('radarventas[ruta_id]', __($labels['radarventas{ruta_id}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{ruta_id}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{ruta_id}')): ?>
    <?php echo form_error('radarventas{ruta_id}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = get_partial('ruta_id', array('type' => 'edit', 'radarventas' => $radarventas,'labels' => $labels,'params' => $params)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{ruta_id}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divcliente_vendedor_por_ruta">
  <?php if($labels['radarventas{cliente_vendedor_por_ruta}']!='.:') { ?>
  <?php echo label_for('radarventas[cliente_vendedor_por_ruta]', __($labels['radarventas{cliente_vendedor_por_ruta}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{cliente_vendedor_por_ruta}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{cliente_vendedor_por_ruta}')): ?>
    <?php echo form_error('radarventas{cliente_vendedor_por_ruta}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = get_partial('cliente_vendedor_por_ruta', array('type' => 'edit', 'radarventas' => $radarventas,'labels' => $labels,'params' => $params)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{cliente_vendedor_por_ruta}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divregistrar_articulos">
  <?php if($labels['radarventas{registrar_articulos}']!='.:') { ?>
  <?php echo label_for('radarventas[registrar_articulos]', __($labels['radarventas{registrar_articulos}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{registrar_articulos}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{registrar_articulos}')): ?>
    <?php echo form_error('radarventas{registrar_articulos}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = get_partial('registrar_articulos', array('type' => 'edit', 'radarventas' => $radarventas,'labels' => $labels,'params' => $params)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{registrar_articulos}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divfecha">
  <?php if($labels['radarventas{fecha}']!='.:') { ?>
  <?php echo label_for('radarventas[fecha]', __($labels['radarventas{fecha}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{fecha}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{fecha}')): ?>
    <?php echo form_error('radarventas{fecha}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = object_input_date_tag($radarventas, 'getFecha', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'radarventas[fecha]',
)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{fecha}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divstatus">
  <?php if($labels['radarventas{status}']!='.:') { ?>
  <?php echo label_for('radarventas[status]', __($labels['radarventas{status}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{status}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{status}')): ?>
    <?php echo form_error('radarventas{status}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = get_partial('status', array('type' => 'edit', 'radarventas' => $radarventas,'labels' => $labels,'params' => $params)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{status}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divfafactur_id">
  <?php if($labels['radarventas{fafactur_id}']!='.:') { ?>
  <?php echo label_for('radarventas[fafactur_id]', __("Factura"), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('radarventas{fafactur_id}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('radarventas{fafactur_id}')): ?>
    <?php echo form_error('radarventas{fafactur_id}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = object_select_tag($radarventas, 'getFafacturId', array (
  'related_class' => 'Fafactur',
  'control_name' => 'radarventas[fafactur_id]',
  'include_blank' => true,
)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['radarventas{fafactur_id}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>
</div>
</fieldset>

<?php include_partial('edit_actions', array('radarventas' => $radarventas)) ?>

</form>

<ul class="sf_admin_actions">
      <li class="float-left"><?php if ($radarventas->getId()): ?>
<?php echo button_to(__('delete'), 'radarventas/delete?id='.$radarventas->getId(), array (
  'post' => true,
  'confirm' => __('Are you sure?'),
  'class' => 'sf_admin_action_delete',
)) ?><?php endif; ?>
</li>
  </ul>

